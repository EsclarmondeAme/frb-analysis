#!/usr/bin/env python3
# standalone harmonic alignment (112A + 111B)
# no files, no csv, all numbers embedded

import math
import pandas as pd

# ------------------------------
# persistent modes from 112A
# ------------------------------
persistent_modes = {
    (0,0): 1.00,
    (1,-1): 1.00,
    (1,0): 1.00,
    (1,1): 1.00,
    (2,-1): 1.00,
    (2,1): 1.00,
    (3,2): 0.50,
    (3,-2): 0.50,
    (2,2): 0.38,
    (2,-2): 0.38,
    (6,-2): 0.25,
    (6,2): 0.25,
}

# ------------------------------
# energy + flux p-values from 111B
# (ALL as pasted by you)
# ------------------------------
energy_flux = {
(0,0):(0.0,1.0),
(1,-1):(0.287,0.999),
(1,0):(0.4835,0.411),
(1,1):(0.287,0.999),
(2,-2):(0.3215,0.973),
(2,-1):(0.0385,0.946),
(2,0):(0.019,0.059),
(2,1):(0.0385,0.946),
(2,2):(0.3215,0.973),
(3,-3):(0.004,0.892),
(3,-2):(0.004,0.9905),
(3,-1):(0.0,0.358),
(3,0):(0.1485,0.7855),
(3,1):(0.0,0.358),
(3,2):(0.004,0.9905),
(3,3):(0.004,0.892),
(4,-4):(0.0005,0.621),
(4,-3):(0.443,0.992),
(4,-2):(0.034,0.835),
(4,-1):(0.001,0.013),
(4,0):(0.586,0.597),
(4,1):(0.001,0.013),
(4,2):(0.034,0.835),
(4,3):(0.443,0.992),
(4,4):(0.0005,0.621),
(5,-5):(0.001,0.138),
(5,-4):(0.793,0.984),
(5,-3):(0.071,0.984),
(5,-2):(0.000,0.092),
(5,-1):(0.167,0.327),
(5,0):(0.021,0.479),
(5,1):(0.167,0.327),
(5,2):(0.000,0.092),
(5,3):(0.071,0.984),
(5,4):(0.793,0.984),
(5,5):(0.001,0.138),
(6,-6):(0.001,0.270),
(6,-5):(0.002,0.959),
(6,-4):(0.180,0.993),
(6,-3):(0.001,0.539),
(6,-2):(0.000,0.172),
(6,-1):(0.148,0.667),
(6,0):(0.003,0.229),
(6,1):(0.148,0.667),
(6,2):(0.000,0.172),
(6,3):(0.001,0.539),
(6,4):(0.180,0.993),
(6,5):(0.002,0.959),
(6,6):(0.001,0.270),
(7,-7):(0.009,0.705),
(7,-6):(0.002,0.923),
(7,-5):(0.046,1.000),
(7,-4):(0.060,0.746),
(7,-3):(0.045,0.127),
(7,-2):(0.000,0.536),
(7,-1):(0.187,0.589),
(7,0):(0.184,0.440),
(7,1):(0.187,0.589),
(7,2):(0.000,0.536),
(7,3):(0.045,0.127),
(7,4):(0.060,0.746),
(7,5):(0.046,1.000),
(7,6):(0.002,0.923),
(7,7):(0.009,0.705),
(8,-8):(0.002,0.882),
(8,-7):(0.009,0.819),
(8,-6):(0.292,0.998),
(8,-5):(0.086,0.812),
(8,-4):(0.000,0.141),
(8,-3):(0.000,0.281),
(8,-2):(0.239,0.720),
(8,-1):(0.008,0.058),
(8,0):(0.099,0.592),
(8,1):(0.008,0.058),
(8,2):(0.239,0.720),
(8,3):(0.000,0.281),
(8,4):(0.000,0.141),
(8,5):(0.086,0.812),
(8,6):(0.292,0.998),
(8,7):(0.009,0.819),
(8,8):(0.002,0.882),
}

# ------------------------------
# compute alignment score
# S = f_lm * (1 - p_E) * (1 - p_F)
# ------------------------------
rows = []

for (l,m), (pE,pF) in energy_flux.items():
    f = persistent_modes.get((l,m), 0.0)
    S = f * (1 - pE) * (1 - pF)
    rows.append((l, m, f, pE, pF, S))

df = pd.DataFrame(rows, columns=["l","m","f_lm","pE","pF","Alignment"])
df = df.sort_values("Alignment", ascending=False)

print(df.to_string(index=False))

print("\nTOP 10 MODES:")
print(df.head(10).to_string(index=False))
